<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>nodejs - debugging | Just For Fun</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 6.3.0"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/." class="title">Just For Fun</a><span class="subtitle"></span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/archives" class="sidebar-nav-item">Archives</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>nodejs - debugging</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2023-07-14</div></div></div><article><div class="container post"><p>今天閱讀郭家寶的Node.js開發指南,才知道Node.js有內建debugger</p>
<h1 id="如何使用Node-js內建debugger"><a href="#如何使用Node-js內建debugger" class="headerlink" title="如何使用Node.js內建debugger?"></a>如何使用Node.js內建debugger?</h1><h2 id="先建立一檔案-debug-js"><a href="#先建立一檔案-debug-js" class="headerlink" title="先建立一檔案 debug.js"></a>先建立一檔案 debug.js</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">var</span> c = <span class="title function_">sum</span>(a, b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">n1, n2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> n1 - n2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;a = &quot;</span> , a);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;b = &quot;</span> , b);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;a + b = &quot;</span> , <span class="title function_">sum</span>(a, b));</span><br></pre></td></tr></table></figure>

<h2 id="啟動debugger"><a href="#啟動debugger" class="headerlink" title="啟動debugger"></a>啟動debugger</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ node inspect debug.js</span><br><span class="line">&lt; Debugger listening on ws://127.0.0.1:9229/8bf45e32-67e5-45f2-8c98-c29fd15f9c2e</span><br><span class="line">&lt; For <span class="built_in">help</span>, see: https://nodejs.org/en/docs/inspector</span><br><span class="line">&lt;</span><br><span class="line">connecting to 127.0.0.1:9229 ... ok</span><br><span class="line">&lt; Debugger attached.</span><br><span class="line">&lt;</span><br><span class="line">Break on start <span class="keyword">in</span> debug.js:1</span><br><span class="line">&gt; 1 var a = 1;</span><br><span class="line">  2 var b = 2;</span><br><span class="line">  3 var c = <span class="built_in">sum</span>(a, b);</span><br><span class="line">debug&gt;</span><br></pre></td></tr></table></figure>

<h2 id="退出debugger"><a href="#退出debugger" class="headerlink" title="退出debugger"></a>退出debugger</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">debug&gt; .<span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<h2 id="使用debugger"><a href="#使用debugger" class="headerlink" title="使用debugger"></a>使用debugger</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">debug&gt; <span class="built_in">help</span></span><br><span class="line">run, restart, r       Run the application or reconnect</span><br><span class="line"><span class="built_in">kill</span>                  Kill a running application or disconnect</span><br><span class="line"></span><br><span class="line">cont, c               Resume execution</span><br><span class="line">next, n               Continue to next line <span class="keyword">in</span> current file</span><br><span class="line">step, s               Step into, potentially entering a <span class="keyword">function</span></span><br><span class="line">out, o                Step out, leaving the current <span class="keyword">function</span></span><br><span class="line">backtrace, bt         Print the current backtrace</span><br><span class="line">list                  Print the <span class="built_in">source</span> around the current line <span class="built_in">where</span> execution</span><br><span class="line">                      is currently paused</span><br><span class="line">setContextLineNumber  Set <span class="built_in">which</span> lines to check <span class="keyword">for</span> context</span><br><span class="line">setBreakpoint, sb     Set a breakpoint</span><br><span class="line">clearBreakpoint, cb   Clear a breakpoint</span><br><span class="line">breakpoints           List all known breakpoints</span><br><span class="line">breakOnException      Pause execution whenever an exception is thrown</span><br><span class="line">breakOnUncaught       Pause execution whenever an exception isn<span class="string">&#x27;t caught</span></span><br><span class="line"><span class="string">breakOnNone           Don&#x27;</span>t pause on exceptions (this is the default)</span><br><span class="line"></span><br><span class="line">watch(<span class="built_in">expr</span>)           Start watching the given expression</span><br><span class="line">unwatch(<span class="built_in">expr</span>)         Stop watching an expression</span><br><span class="line">unwatch(index)        Stop watching an expression at specific index from watch list</span><br><span class="line">watchers              Print all watched expressions and their current values</span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span>(<span class="built_in">expr</span>), p(<span class="built_in">expr</span>), <span class="built_in">exec</span> <span class="built_in">expr</span>, p <span class="built_in">expr</span></span><br><span class="line">                      Evaluate the expression and <span class="built_in">print</span> the value</span><br><span class="line">repl                  Enter a debug repl that works like <span class="built_in">exec</span></span><br><span class="line"></span><br><span class="line">scripts               List application scripts that are currently loaded</span><br><span class="line">scripts(<span class="literal">true</span>)         List all scripts (including node-internals)</span><br><span class="line"></span><br><span class="line">profile               Start CPU profiling session.</span><br><span class="line">profileEnd            Stop current CPU profiling session.</span><br><span class="line">profiles              Array of completed CPU profiling sessions.</span><br><span class="line">profiles[n].save(filepath = <span class="string">&#x27;node.cpuprofile&#x27;</span>)</span><br><span class="line">                      Save CPU profiling session to disk as JSON.</span><br><span class="line"></span><br><span class="line">takeHeapSnapshot(filepath = <span class="string">&#x27;node.heapsnapshot&#x27;</span>)</span><br><span class="line">                      Take a heap snapshot and save to disk as JSON.</span><br></pre></td></tr></table></figure>

<h3 id="下一步"><a href="#下一步" class="headerlink" title="下一步"></a>下一步</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">debug&gt; n</span><br><span class="line"><span class="built_in">break</span> <span class="keyword">in</span> debug.js:2</span><br><span class="line">  1 var a = 1;</span><br><span class="line">&gt; 2 var b = 2;</span><br><span class="line">  3 var c = <span class="built_in">sum</span>(a, b);</span><br><span class="line">  4</span><br></pre></td></tr></table></figure>

<h3 id="設定監看運算式或變數"><a href="#設定監看運算式或變數" class="headerlink" title="設定監看運算式或變數"></a>設定監看運算式或變數</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">debug&gt; watch(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">debug&gt; watchers</span><br></pre></td></tr></table></figure>

<h3 id="查看已設定要監看的變數"><a href="#查看已設定要監看的變數" class="headerlink" title="查看已設定要監看的變數"></a>查看已設定要監看的變數</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">debug&gt; watchers</span><br><span class="line">  0: c = undefined</span><br></pre></td></tr></table></figure>
<h3 id="設定斷點"><a href="#設定斷點" class="headerlink" title="設定斷點"></a>設定斷點</h3><p>設定斷點使用 <code>sb(行號)</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">debug&gt; sb(3)</span><br><span class="line"><span class="built_in">break</span> <span class="keyword">in</span> debug.js:2</span><br><span class="line">  1 var a = 1;</span><br><span class="line">  2 var b = 2;</span><br><span class="line">&gt; 3 var c = <span class="built_in">sum</span>(a, b);</span><br><span class="line">  4</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">debug&gt; n</span><br><span class="line"><span class="built_in">break</span> <span class="keyword">in</span> debug.js:3</span><br><span class="line">Watchers:</span><br><span class="line">  0: c = undefined</span><br><span class="line">  1: c = undefined</span><br><span class="line"></span><br><span class="line">  1 var a = 1;</span><br><span class="line">  2 var b = 2;</span><br><span class="line">&gt; 3 var c = <span class="built_in">sum</span>(a, b);</span><br><span class="line">  4</span><br><span class="line">  5 <span class="keyword">function</span> <span class="built_in">sum</span>(n1, n2) &#123;</span><br></pre></td></tr></table></figure>

<h2 id="More-Info"><a href="#More-Info" class="headerlink" title="More Info :"></a>More Info :</h2><ul>
<li><a target="_blank" rel="noopener" href="https://nodejs.org/en/docs/guides/debugging-getting-started">Debugging Guide</a></li>
<li><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10185502">Day9 - node.js 內建除錯</a></li>
</ul>
</div><!-- comment system--><div class="container"><hr></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2023 <a href="/" rel="nofollow">Ray Kuo</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>